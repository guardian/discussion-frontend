{"version":3,"sources":["../node_modules/preact/src/vnode.js","../node_modules/preact/src/util.js","../node_modules/preact/src/h.js","../node_modules/preact/src/linked-state.js","../node_modules/preact/src/render-queue.js","../node_modules/preact/src/vdom/functional-component.js","../node_modules/preact/src/dom/index.js","../node_modules/preact/src/vdom/index.js","../node_modules/preact/src/dom/recycler.js","../node_modules/preact/src/vdom/diff.js","../node_modules/preact/src/vdom/component-recycler.js","../node_modules/preact/src/vdom/component.js","../node_modules/preact/src/component.js","../node_modules/preact/src/render.js","../node_modules/preact-compat/src/index.js","../src/utils/url.js","../src/utils/net.js","../src/net/discussion-api.js","../src/index.js","../node_modules/preact/src/options.js","../bin/lib/react-proptypes-prod.js","../node_modules/preact/src/constants.js","../src/ui/comment-count.js","../src/ui/avatar.js","../src/ui/identity.js","../src/ui/discussion-view.js","../node_modules/tiny-emitter/index.js","../src/utils/mediator.js","../src/model/discussion.js","../node_modules/whatwg-fetch/fetch.js"],"names":["VNode","nodeName","attributes","children","key","extend","obj","props","i","undefined","clone","delve","p","split","length","isFunction","isString","empty","x","falsey","value","hashToClassName","c","str","prop","h","firstChild","len","arguments","arr","lastSimple","type","_typeof","String","join","SHARED_TEMP_ARRAY","j","child","simple","push","class","className","options","vnode","createLinkedState","component","eventPath","path","p0","e","t","currentTarget","this","s","state","v","match","checked","setState","defineProperty","enqueueRender","items","debounceRendering","defer","rerender","currentItems","itemsOffline","pop","_dirty","renderComponent","isFunctionalComponent","prototype","render","buildFunctionalComponent","context","getNodeProps","EMPTY","ensureNodeData","node","data","ATTR_KEY","getNodeType","Text","Element","removeNode","parentNode","removeChild","setAccessor","name","old","isSvg","style","cssText","NON_DIMENSION_PROPS","innerHTML","__html","l","_listeners","toLowerCase","substring","addEventListener","eventProxy","NON_BUBBLING_EVENTS","removeEventListener","removeAttribute","ns","removeAttributeNS","setAttributeNS","setAttribute","setProperty","event","getRawNodeAttributes","attrs","isSameNodeType","isNamedNode","_componentConstructor","normalizedNodeName","defaultProps","collectNode","list","nodes","createNode","document","createElementNS","createElement","cleanNode","_component","flushMounts","mounts","componentDidMount","diff","dom","mountAll","parent","rootComponent","ret","idiff","appendChild","diffLevel","originalAttributes","nodeType","createComment","nodeValue","createTextNode","out","prevSvgMode","isSvgMode","buildComponentFromVNode","childNodes","ref","innerDiffNode","vchildren","originalChildren","keyed","keyedLen","min","childrenLen","vlen","vchild","__key","insertBefore","removeOrphanedChildren","unmountOnly","recollectNodeTree","diffAttributes","collectComponent","constructor","components","createComponent","Ctor","inst","nextBase","splice","triggerComponentRender","setComponentProps","opts","b","base","_disableRendering","__ref","componentWillMount","componentWillReceiveProps","prevContext","prevProps","NO_RENDER","SYNC_RENDER","syncComponentUpdates","skip","rendered","previousProps","previousState","prevState","previousContext","isUpdate","initialBase","initialChildComponent","FORCE_RENDER","shouldComponentUpdate","componentWillUpdate","getChildContext","childComponent","toUnmount","childProps","_parentComponent","cbase","baseParent","replaceChild","componentRef","unshift","componentDidUpdate","cb","_renderCallbacks","fn","call","oldDom","isDirectOwner","isOwner","ASYNC_RENDER","unmountComponent","remove","componentWillUnmount","inner","componentDidUnmount","Component","_linkedStates","getInitialState","merge","callback","prev","_preactCompatRendered","preactRender","createFactory","bind","upgradeToVNodes","offset","Array","isArray","isValidElement","isStatelessComponent","wrapStatelessComponent","WrappedComponent","statelessComponentHook","Wrapped","COMPONENT_WRAPPER_KEY","configurable","displayName","propTypes","args","_len","_key","normalizeVNode","currentComponent","createStringRefProxy","element","$$typeof","REACT_ELEMENT_TYPE","_refProxies","resolved","refs","applyEventNormalization","_ref","onchange","attr","normalized","multihook","applyClassName","_ref2","cl","all","callMethod","ctx","m","apply","hooks","r","newComponentHook","propsHook","beforeRender","afterRender","babelHelpers.typeof","DEV","ctor","hasOwnProperty","err","console","error","Error","message","BYPASS_HOOK","paths","replace","inject","Promise","json","fetch","then","resp","ok","reject","statusText","jsonp","resolve","jsonpCallback","Math","floor","random","Date","getTime","jsonpPath","indexOf","script","src","onerror","head","create","commentCount","ids","url","apiHost","catch","ex","emit","userProfile","id","response","status","net","defaultNet","_net$json","_net$jsonp","avatarImagesHost","closed","discussionId","_ref$net","profileUrl","profileClientId","user","userFromCookie","_ref$Promise","window","api","createApi","React.createElement","Discussion","mediator","module","exports","lcCache","f","setTimeout","Symbol","for","boxFlexGroup","columnCount","fillOpacity","flex","flexGrow","flexShrink","flexNegative","fontWeight","lineClamp","lineHeight","order","orphans","strokeOpacity","widows","zIndex","zoom","blur","focus","load","resize","scroll","cacheKey","ELEMENTS","Object","oldVnodeHook","a","tag","isCompat","Function","isExtensible","ContextProvider","DOM","PreactComponent","CommentCount","count","styles","Avatar","userId","avatarSrc","container","avatarWrapper","avatarImage","alt","styleHelpers","borderBox","label","author","Identity","anonymous","loading","profile","signIn","register","underline","href","privateFields","canPostComment","DiscussionView","commentsCount","E","listener","off","self","_","on","slice","evtArr","evts","liveEvents","EventEmitter","_this","getCommentCount","getUser","counts","_props","condition","_props2","_extends","React","normalizeName","test","TypeError","normalizeValue","iteratorFor","iterator","shift","done","support","iterable","Headers","headers","map","forEach","append","getOwnPropertyNames","consumed","body","bodyUsed","fileReaderReady","reader","onload","result","readBlobAsArrayBuffer","blob","FileReader","readAsArrayBuffer","readBlobAsText","readAsText","Body","_initBody","_bodyInit","_bodyText","Blob","isPrototypeOf","_bodyBlob","formData","FormData","_bodyFormData","searchParams","URLSearchParams","arrayBuffer","ArrayBuffer","get","set","rejected","text","decode","JSON","parse","normalizeMethod","method","upcased","toUpperCase","methods","Request","input","credentials","mode","referrer","form","trim","bytes","decodeURIComponent","xhr","pairs","getAllResponseHeaders","header","Response","bodyInit","values","getAll","has","thisArg","keys","entries","redirectStatuses","redirect","RangeError","location","init","responseURL","getResponseHeader","request","XMLHttpRequest","responseText","ontimeout","open","withCredentials","responseType","setRequestHeader","send","polyfill"],"mappings":"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","file":"discussion-frontend.preact.amd.e34499b4c4.js.map","sourcesContent":["/** Virtual DOM Node */\nexport function VNode(nodeName, attributes, children) {\n\t/** @type {string|function} */\n\tthis.nodeName = nodeName;\n\n\t/** @type {object<string>|undefined} */\n\tthis.attributes = attributes;\n\n\t/** @type {array<VNode>|undefined} */\n\tthis.children = children;\n\n\t/** Reference to the given key. */\n\tthis.key = attributes && attributes.key;\n}\n","/** Copy own-properties from `props` onto `obj`.\n *\t@returns obj\n *\t@private\n */\nexport function extend(obj, props) {\n\tif (props) {\n\t\tfor (let i in props) {\n\t\t\tif (props[i]!==undefined) {\n\t\t\t\tobj[i] = props[i];\n\t\t\t}\n\t\t}\n\t}\n\treturn obj;\n}\n\n\n/** Fast clone. Note: does not filter out non-own properties.\n *\t@see https://esbench.com/bench/56baa34f45df6895002e03b6\n */\nexport function clone(obj) {\n\treturn extend({}, obj);\n}\n\n\n/** Get a deep property value from the given object, expressed in dot-notation.\n *\t@private\n */\nexport function delve(obj, key) {\n\tfor (let p=key.split('.'), i=0; i<p.length && obj; i++) {\n\t\tobj = obj[p[i]];\n\t}\n\treturn obj;\n}\n\n\n/** Convert an Array-like object to an Array\n *\t@private\n */\nexport function toArray(obj, offset) {\n\treturn [].slice.call(obj, offset);\n}\n\n\n/** @private is the given object a Function? */\nexport function isFunction(obj) {\n\treturn 'function'===typeof obj;\n}\n\n\n/** @private is the given object a String? */\nexport function isString(obj) {\n\treturn 'string'===typeof obj;\n}\n\n\n/** Check if a value is `null` or `undefined`.\n *\t@private\n */\nexport function empty(x) {\n\treturn x===undefined || x===null;\n}\n\n\n/** Check if a value is `null`, `undefined`, or explicitly `false`. */\nexport function falsey(value) {\n\treturn value===false || empty(value);\n}\n\n\n/** Convert a hashmap of CSS classes to a space-delimited className string\n *\t@private\n */\nexport function hashToClassName(c) {\n\tlet str = '';\n\tfor (let prop in c) {\n\t\tif (c[prop]) {\n\t\t\tif (str) str += ' ';\n\t\t\tstr += prop;\n\t\t}\n\t}\n\treturn str;\n}\n\n\n/** Just a memoized String#toLowerCase */\nlet lcCache = {};\nexport const toLowerCase = s => lcCache[s] || (lcCache[s] = s.toLowerCase());\n\n\n/** Call a function asynchronously, as soon as possible.\n *\t@param {Function} callback\n */\nlet resolved = typeof Promise!=='undefined' && Promise.resolve();\nexport const defer = resolved ? (f => { resolved.then(f); }) : setTimeout;\n","import { VNode } from './vnode';\nimport options from './options';\nimport { falsey, isFunction, isString, hashToClassName } from './util';\n\n\nconst SHARED_TEMP_ARRAY = [];\n\n\n/** JSX/hyperscript reviver\n *\t@see http://jasonformat.com/wtf-is-jsx\n *\t@public\n *  @example\n *  /** @jsx h *\\/\n *  import { render, h } from 'preact';\n *  render(<span>foo</span>, document.body);\n */\nexport function h(nodeName, attributes, firstChild) {\n\tlet len = arguments.length,\n\t\tchildren, arr, lastSimple;\n\n\n\tif (len>2) {\n\t\tlet type = typeof firstChild;\n\t\tif (len===3 && type!=='object' && type!=='function') {\n\t\t\tif (!falsey(firstChild)) {\n\t\t\t\tchildren = [String(firstChild)];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tchildren = [];\n\t\t\tfor (let i=2; i<len; i++) {\n\t\t\t\tlet p = arguments[i];\n\t\t\t\tif (falsey(p)) continue;\n\t\t\t\tif (p.join) arr = p;\n\t\t\t\telse (arr = SHARED_TEMP_ARRAY)[0] = p;\n\t\t\t\tfor (let j=0; j<arr.length; j++) {\n\t\t\t\t\tlet child = arr[j],\n\t\t\t\t\t\tsimple = !(falsey(child) || isFunction(child) || child instanceof VNode);\n\t\t\t\t\tif (simple && !isString(child)) child = String(child);\n\t\t\t\t\tif (simple && lastSimple) {\n\t\t\t\t\t\tchildren[children.length-1] += child;\n\t\t\t\t\t}\n\t\t\t\t\telse if (!falsey(child)) {\n\t\t\t\t\t\tchildren.push(child);\n\t\t\t\t\t\tlastSimple = simple;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse if (attributes && attributes.children) {\n\t\treturn h(nodeName, attributes, attributes.children);\n\t}\n\n\tif (attributes) {\n\t\tif (attributes.children) {\n\t\t\tdelete attributes.children;\n\t\t}\n\n\t\tif (!isFunction(nodeName)) {\n\t\t\t// normalize className to class.\n\t\t\tif ('className' in attributes) {\n\t\t\t\tattributes.class = attributes.className;\n\t\t\t\tdelete attributes.className;\n\t\t\t}\n\n\t\t\tlastSimple = attributes.class;\n\t\t\tif (lastSimple && !isString(lastSimple)) {\n\t\t\t\tattributes.class = hashToClassName(lastSimple);\n\t\t\t}\n\t\t}\n\t}\n\n\tlet p = new VNode(nodeName, attributes || undefined, children);\n\n\t// if a \"vnode hook\" is defined, pass every created VNode to it\n\tif (options.vnode) options.vnode(p);\n\n\treturn p;\n}\n","import { isString, delve } from './util';\n\n/** Create an Event handler function that sets a given state property.\n *\t@param {Component} component\tThe component whose state should be updated\n *\t@param {string} key\t\t\t\tA dot-notated key path to update in the component's state\n *\t@param {string} eventPath\t\tA dot-notated key path to the value that should be retrieved from the Event or component\n *\t@returns {function} linkedStateHandler\n *\t@private\n */\nexport function createLinkedState(component, key, eventPath) {\n\tlet path = key.split('.'),\n\t\tp0 = path[0];\n\treturn function(e) {\n\t\tlet t = e && e.currentTarget || this,\n\t\t\ts = component.state,\n\t\t\tobj = s,\n\t\t\tv, i;\n\t\tif (isString(eventPath)) {\n\t\t\tv = delve(e, eventPath);\n\t\t}\n\t\telse {\n\t\t\tv = t.nodeName ? ((t.nodeName+t.type).match(/^input(check|rad)/i) ? t.checked : t.value) : e;\n\t\t}\n\t\tif (path.length>1) {\n\t\t\tfor (i=0; i<path.length-1; i++) {\n\t\t\t\tobj = obj[path[i]] || (obj[path[i]] = {});\n\t\t\t}\n\t\t\tobj[path[i]] = v;\n\t\t\tv = s[p0];\n\t\t}\n\t\tcomponent.setState({ [p0]: v });\n\t};\n}\n","import options from './options';\nimport { defer } from './util';\nimport { renderComponent } from './vdom/component';\n\n/** Managed queue of dirty components to be re-rendered */\n\n// items/itemsOffline swap on each rerender() call (just a simple pool technique)\nlet items = [],\n\titemsOffline = [];\n\nexport function enqueueRender(component) {\n\tif (items.push(component)!==1) return;\n\n\t(options.debounceRendering || defer)(rerender);\n}\n\n\nexport function rerender() {\n\tif (!items.length) return;\n\n\tlet currentItems = items,\n\t\tp;\n\n\t// swap online & offline\n\titems = itemsOffline;\n\titemsOffline = currentItems;\n\n\twhile ( (p = currentItems.pop()) ) {\n\t\tif (p._dirty) renderComponent(p);\n\t}\n}\n","import { EMPTY } from '../constants';\nimport { getNodeProps } from './index';\nimport { isFunction } from '../util';\n\n\n/** Check if a VNode is a reference to a stateless functional component.\n *\tA function component is represented as a VNode whose `nodeName` property is a reference to a function.\n *\tIf that function is not a Component (ie, has no `.render()` method on a prototype), it is considered a stateless functional component.\n *\t@param {VNode} vnode\tA VNode\n *\t@private\n */\nexport function isFunctionalComponent(vnode) {\n\tlet nodeName = vnode && vnode.nodeName;\n\treturn nodeName && isFunction(nodeName) && !(nodeName.prototype && nodeName.prototype.render);\n}\n\n\n\n/** Construct a resultant VNode from a VNode referencing a stateless functional component.\n *\t@param {VNode} vnode\tA VNode with a `nodeName` property that is a reference to a function.\n *\t@private\n */\nexport function buildFunctionalComponent(vnode, context) {\n\treturn vnode.nodeName(getNodeProps(vnode), context || EMPTY);\n}\n","import { ATTR_KEY, NON_DIMENSION_PROPS, NON_BUBBLING_EVENTS } from '../constants';\nimport options from '../options';\nimport { toLowerCase, empty, falsey, isString, isFunction } from '../util';\n\n\nexport function ensureNodeData(node, data) {\n\treturn node[ATTR_KEY] || (node[ATTR_KEY] = (data || {}));\n}\n\n\nexport function getNodeType(node) {\n\tif (node instanceof Text) return 3;\n\tif (node instanceof Element) return 1;\n\treturn 0;\n}\n\n\n/** Removes a given DOM Node from its parent. */\nexport function removeNode(node) {\n\tlet p = node.parentNode;\n\tif (p) p.removeChild(node);\n}\n\n\n/** Set a named attribute on the given Node, with special behavior for some names and event handlers.\n *\tIf `value` is `null`, the attribute/handler will be removed.\n *\t@param {Element} node\tAn element to mutate\n *\t@param {string} name\tThe name/key to set, such as an event or attribute name\n *\t@param {any} value\t\tAn attribute value, such as a function to be used as an event handler\n *\t@param {any} previousValue\tThe last value that was set for this name/node pair\n *\t@private\n */\nexport function setAccessor(node, name, value, old, isSvg) {\n\tensureNodeData(node)[name] = value;\n\n\tif (name==='key' || name==='children' || name==='innerHTML') return;\n\n\tif (name==='class' && !isSvg) {\n\t\tnode.className = value || '';\n\t}\n\telse if (name==='style') {\n\t\tif (!value || isString(value) || isString(old)) {\n\t\t\tnode.style.cssText = value || '';\n\t\t}\n\t\tif (value && typeof value==='object') {\n\t\t\tif (!isString(old)) {\n\t\t\t\tfor (let i in old) if (!(i in value)) node.style[i] = '';\n\t\t\t}\n\t\t\tfor (let i in value) {\n\t\t\t\tnode.style[i] = typeof value[i]==='number' && !NON_DIMENSION_PROPS[i] ? (value[i]+'px') : value[i];\n\t\t\t}\n\t\t}\n\t}\n\telse if (name==='dangerouslySetInnerHTML') {\n\t\tif (value) node.innerHTML = value.__html;\n\t}\n\telse if (name[0]=='o' && name[1]=='n') {\n\t\tlet l = node._listeners || (node._listeners = {});\n\t\tname = toLowerCase(name.substring(2));\n\t\t// @TODO: this might be worth it later, un-breaks focus/blur bubbling in IE9:\n\t\t// if (node.attachEvent) name = name=='focus'?'focusin':name=='blur'?'focusout':name;\n\t\tif (value) {\n\t\t\tif (!l[name]) node.addEventListener(name, eventProxy, !!NON_BUBBLING_EVENTS[name]);\n\t\t}\n\t\telse if (l[name]) {\n\t\t\tnode.removeEventListener(name, eventProxy, !!NON_BUBBLING_EVENTS[name]);\n\t\t}\n\t\tl[name] = value;\n\t}\n\telse if (name!=='list' && name!=='type' && !isSvg && name in node) {\n\t\tsetProperty(node, name, empty(value) ? '' : value);\n\t\tif (falsey(value)) node.removeAttribute(name);\n\t}\n\telse {\n\t\tlet ns = isSvg && name.match(/^xlink\\:?(.+)/);\n\t\tif (falsey(value)) {\n\t\t\tif (ns) node.removeAttributeNS('http://www.w3.org/1999/xlink', toLowerCase(ns[1]));\n\t\t\telse node.removeAttribute(name);\n\t\t}\n\t\telse if (typeof value!=='object' && !isFunction(value)) {\n\t\t\tif (ns) node.setAttributeNS('http://www.w3.org/1999/xlink', toLowerCase(ns[1]), value);\n\t\t\telse node.setAttribute(name, value);\n\t\t}\n\t}\n}\n\n\n/** Attempt to set a DOM property to the given value.\n *\tIE & FF throw for certain property-value combinations.\n */\nfunction setProperty(node, name, value) {\n\ttry {\n\t\tnode[name] = value;\n\t} catch (e) { }\n}\n\n\n/** Proxy an event to hooked event handlers\n *\t@private\n */\nfunction eventProxy(e) {\n\treturn this._listeners[e.type](options.event && options.event(e) || e);\n}\n\n/** Get a node's attributes as a hashmap.\n *\t@private\n */\nexport function getRawNodeAttributes(node) {\n\tlet attrs = {};\n\tfor (let i=node.attributes.length; i--; ) {\n\t\tattrs[node.attributes[i].name] = node.attributes[i].value;\n\t}\n\treturn attrs;\n}\n","import { clone, extend, isString, isFunction, toLowerCase } from '../util';\nimport { isFunctionalComponent } from './functional-component';\nimport { getNodeType } from '../dom/index';\n\n\n/** Check if two nodes are equivalent.\n *\t@param {Element} node\n *\t@param {VNode} vnode\n *\t@private\n */\nexport function isSameNodeType(node, vnode) {\n\tif (isString(vnode)) {\n\t\treturn getNodeType(node)===3;\n\t}\n\tif (isString(vnode.nodeName)) {\n\t\treturn isNamedNode(node, vnode.nodeName);\n\t}\n\tif (isFunction(vnode.nodeName)) {\n\t\treturn node._componentConstructor===vnode.nodeName || isFunctionalComponent(vnode);\n\t}\n}\n\n\nexport function isNamedNode(node, nodeName) {\n\treturn node.normalizedNodeName===nodeName || toLowerCase(node.nodeName)===toLowerCase(nodeName);\n}\n\n\n/**\n * Reconstruct Component-style `props` from a VNode.\n * Ensures default/fallback values from `defaultProps`:\n * Own-properties of `defaultProps` not present in `vnode.attributes` are added.\n * @param {VNode} vnode\n * @returns {Object} props\n */\nexport function getNodeProps(vnode) {\n\tlet defaultProps = vnode.nodeName.defaultProps,\n\t\tprops = clone(defaultProps || vnode.attributes);\n\n\tif (defaultProps) extend(props, vnode.attributes);\n\n\tif (vnode.children) props.children = vnode.children;\n\n\treturn props;\n}\n","import { toLowerCase } from '../util';\nimport { ensureNodeData, getNodeType, getRawNodeAttributes, removeNode } from './index';\n\n/** DOM node pool, keyed on nodeName. */\n\nconst nodes = {};\n\nexport function collectNode(node) {\n\tremoveNode(node);\n\tif (getNodeType(node)!==1) return;\n\tcleanNode(node);\n\tlet name = toLowerCase(node.nodeName),\n\t\tlist = nodes[name];\n\tif (list) list.push(node);\n\telse nodes[name] = [node];\n}\n\n\nexport function createNode(nodeName, isSvg) {\n\tlet name = toLowerCase(nodeName),\n\t\tnode = nodes[name] && nodes[name].pop() || (isSvg ? document.createElementNS('http://www.w3.org/2000/svg', nodeName) : document.createElement(nodeName));\n\tensureNodeData(node);\n\tnode.normalizedNodeName = name;\n\treturn node;\n}\n\n\nfunction cleanNode(node) {\n\t// When reclaiming externally created nodes, seed the attribute cache: (Issue #97)\n\n\tensureNodeData(node, getRawNodeAttributes(node));\n\n\tnode._component = node._componentConstructor = null;\n\n\t// if (node.childNodes.length>0) {\n\t// \tconsole.trace(`Warning: Recycler collecting <${node.nodeName}> with ${node.childNodes.length} children.`);\n\t// \tfor (let i=node.childNodes.length; i--; ) collectNode(node.childNodes[i]);\n\t// }\n}\n","import { ATTR_KEY } from '../constants';\nimport { empty, isString, isFunction } from '../util';\nimport { isSameNodeType, isNamedNode } from './index';\nimport { isFunctionalComponent, buildFunctionalComponent } from './functional-component';\nimport { buildComponentFromVNode } from './component';\nimport { setAccessor, getRawNodeAttributes, getNodeType } from '../dom/index';\nimport { createNode, collectNode } from '../dom/recycler';\nimport { unmountComponent } from './component';\n\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nexport const mounts = [];\n\n/** Diff recursion count, used to track the end of the diff cycle. */\nexport let diffLevel = 0;\n\nlet isSvgMode = false;\n\n\nexport function flushMounts() {\n\tlet c;\n\twhile ((c=mounts.pop())) {\n\t\tif (c.componentDidMount) c.componentDidMount();\n\t}\n}\n\n\n/** Apply differences in a given vnode (and it's deep children) to a real DOM Node.\n *\t@param {Element} [dom=null]\t\tA DOM node to mutate into the shape of the `vnode`\n *\t@param {VNode} vnode\t\t\tA VNode (with descendants forming a tree) representing the desired DOM structure\n *\t@returns {Element} dom\t\t\tThe created/mutated element\n *\t@private\n */\nexport function diff(dom, vnode, context, mountAll, parent, rootComponent) {\n\tdiffLevel++;\n\tlet ret = idiff(dom, vnode, context, mountAll, rootComponent);\n\tif (parent && ret.parentNode!==parent) parent.appendChild(ret);\n\tif (!--diffLevel) flushMounts();\n\treturn ret;\n}\n\n\nfunction idiff(dom, vnode, context, mountAll, rootComponent) {\n\tlet originalAttributes = vnode && vnode.attributes;\n\n\twhile (isFunctionalComponent(vnode)) {\n\t\tvnode = buildFunctionalComponent(vnode, context);\n\t}\n\n\tif (empty(vnode)) {\n\t\tvnode = '';\n\t\tif (rootComponent) {\n\t\t\tif (dom) {\n\t\t\t\tif (dom.nodeType===8) return dom;\n\t\t\t\trecollectNodeTree(dom);\n\t\t\t}\n\t\t\treturn document.createComment(vnode);\n\t\t}\n\t}\n\n\tif (isString(vnode)) {\n\t\tif (dom) {\n\t\t\tif (getNodeType(dom)===3 && dom.parentNode) {\n\t\t\t\tdom.nodeValue = vnode;\n\t\t\t\treturn dom;\n\t\t\t}\n\t\t\trecollectNodeTree(dom);\n\t\t}\n\t\treturn document.createTextNode(vnode);\n\t}\n\n\tlet out = dom,\n\t\tnodeName = vnode.nodeName,\n\t\tprevSvgMode = isSvgMode;\n\n\tif (isFunction(nodeName)) {\n\t\treturn buildComponentFromVNode(dom, vnode, context, mountAll);\n\t}\n\n\tif (!isString(nodeName)) {\n\t\tnodeName = String(nodeName);\n\t}\n\n\tisSvgMode = nodeName==='svg' ? true : nodeName==='foreignObject' ? false : isSvgMode;\n\n\tif (!dom) {\n\t\tout = createNode(nodeName, isSvgMode);\n\t}\n\telse if (!isNamedNode(dom, nodeName)) {\n\t\tout = createNode(nodeName, isSvgMode);\n\t\t// move children into the replacement node\n\t\twhile (dom.firstChild) out.appendChild(dom.firstChild);\n\t\t// reclaim element nodes\n\t\trecollectNodeTree(dom);\n\t}\n\n\t// fast-path for elements containing a single TextNode:\n\tif (vnode.children && vnode.children.length===1 && typeof vnode.children[0]==='string' && out.childNodes.length===1 && out.firstChild instanceof Text) {\n\t\tout.firstChild.nodeValue = vnode.children[0];\n\t}\n\telse if (vnode.children || out.firstChild) {\n\t\tinnerDiffNode(out, vnode.children, context, mountAll);\n\t}\n\n\tdiffAttributes(out, vnode.attributes);\n\n\tif (originalAttributes && originalAttributes.ref) {\n\t\t(out[ATTR_KEY].ref = originalAttributes.ref)(out);\n\t}\n\n\tisSvgMode = prevSvgMode;\n\n\treturn out;\n}\n\n\n/** Apply child and attribute changes between a VNode and a DOM Node to the DOM. */\nfunction innerDiffNode(dom, vchildren, context, mountAll) {\n\tlet originalChildren = dom.childNodes,\n\t\tchildren = [],\n\t\tkeyed = {},\n\t\tkeyedLen = 0,\n\t\tmin = 0,\n\t\tlen = originalChildren.length,\n\t\tchildrenLen = 0,\n\t\tvlen = vchildren && vchildren.length,\n\t\tj, c, vchild, child;\n\n\tif (len) {\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet child = originalChildren[i],\n\t\t\t\tkey = vlen ? ((c = child._component) ? c.__key : (c = child[ATTR_KEY]) ? c.key : null) : null;\n\t\t\tif (key || key===0) {\n\t\t\t\tkeyedLen++;\n\t\t\t\tkeyed[key] = child;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchildren[childrenLen++] = child;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (vlen) {\n\t\tfor (let i=0; i<vlen; i++) {\n\t\t\tvchild = vchildren[i];\n\t\t\tchild = null;\n\n\t\t\t// if (isFunctionalComponent(vchild)) {\n\t\t\t// \tvchild = buildFunctionalComponent(vchild);\n\t\t\t// }\n\n\t\t\t// attempt to find a node based on key matching\n\t\t\tlet key = vchild.key;\n\t\t\tif (!empty(key)) {\n\t\t\t\tif (keyedLen && key in keyed) {\n\t\t\t\t\tchild = keyed[key];\n\t\t\t\t\tkeyed[key] = undefined;\n\t\t\t\t\tkeyedLen--;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// attempt to pluck a node of the same type from the existing children\n\t\t\telse if (!child && min<childrenLen) {\n\t\t\t\tfor (j=min; j<childrenLen; j++) {\n\t\t\t\t\tc = children[j];\n\t\t\t\t\tif (c && isSameNodeType(c, vchild)) {\n\t\t\t\t\t\tchild = c;\n\t\t\t\t\t\tchildren[j] = undefined;\n\t\t\t\t\t\tif (j===childrenLen-1) childrenLen--;\n\t\t\t\t\t\tif (j===min) min++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!child && min<childrenLen && isFunction(vchild.nodeName) && mountAll) {\n\t\t\t\t\tchild = children[min];\n\t\t\t\t\tchildren[min++] = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// morph the matched/found/created DOM child to match vchild (deep)\n\t\t\tchild = idiff(child, vchild, context, mountAll);\n\n\t\t\tif (child!==originalChildren[i]) {\n\t\t\t\tdom.insertBefore(child, originalChildren[i] || null);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tif (keyedLen) {\n\t\t/*eslint guard-for-in:0*/\n\t\tfor (let i in keyed) if (keyed[i]) {\n\t\t\tchildren[min=childrenLen++] = keyed[i];\n\t\t}\n\t}\n\n\t// remove orphaned children\n\tif (min<childrenLen) {\n\t\tremoveOrphanedChildren(children);\n\t}\n}\n\n\n/** Reclaim children that were unreferenced in the desired VTree */\nexport function removeOrphanedChildren(children, unmountOnly) {\n\tfor (let i=children.length; i--; ) {\n\t\tlet child = children[i];\n\t\tif (child) {\n\t\t\trecollectNodeTree(child, unmountOnly);\n\t\t}\n\t}\n}\n\n\n/** Reclaim an entire tree of nodes, starting at the root. */\nexport function recollectNodeTree(node, unmountOnly) {\n\t// @TODO: Need to make a call on whether Preact should remove nodes not created by itself.\n\t// Currently it *does* remove them. Discussion: https://github.com/developit/preact/issues/39\n\t//if (!node[ATTR_KEY]) return;\n\n\tlet component = node._component;\n\tif (component) {\n\t\tunmountComponent(component, !unmountOnly);\n\t}\n\telse {\n\t\tif (node[ATTR_KEY] && node[ATTR_KEY].ref) node[ATTR_KEY].ref(null);\n\n\t\tif (!unmountOnly) {\n\t\t\tcollectNode(node);\n\t\t}\n\n\t\tif (node.childNodes && node.childNodes.length) {\n\t\t\tremoveOrphanedChildren(node.childNodes, unmountOnly);\n\t\t}\n\t}\n}\n\n\n/** Apply differences in attributes from a VNode to the given DOM Node. */\nfunction diffAttributes(dom, attrs) {\n\tlet old = dom[ATTR_KEY] || getRawNodeAttributes(dom);\n\n\t// removeAttributes(dom, old, attrs || EMPTY);\n\tfor (let name in old) {\n\t\tif (!attrs || !(name in attrs)) {\n\t\t\tsetAccessor(dom, name, null, old[name], isSvgMode);\n\t\t}\n\t}\n\n\t// new & updated\n\tif (attrs) {\n\t\tfor (let name in attrs) {\n\t\t\tif (!(name in old) || attrs[name]!=old[name] || ((name==='value' || name==='checked') && attrs[name]!=dom[name])) {\n\t\t\t\tsetAccessor(dom, name, attrs[name], old[name], isSvgMode);\n\t\t\t}\n\t\t}\n\t}\n}\n","/** Retains a pool of Components for re-use, keyed on component name.\n *\tNote: since component names are not unique or even necessarily available, these are primarily a form of sharding.\n *\t@private\n */\nconst components = {};\n\n\nexport function collectComponent(component) {\n\tlet name = component.constructor.name,\n\t\tlist = components[name];\n\tif (list) list.push(component);\n\telse components[name] = [component];\n}\n\n\nexport function createComponent(Ctor, props, context) {\n\tlet inst = new Ctor(props, context),\n\t\tlist = components[Ctor.name];\n\tinst.props = props;\n\tinst.context = context;\n\tif (list) {\n\t\tfor (let i=list.length; i--; ) {\n\t\t\tif (list[i].constructor===Ctor) {\n\t\t\t\tinst.nextBase = list[i].nextBase;\n\t\t\t\tlist.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn inst;\n}\n","import { SYNC_RENDER, NO_RENDER, FORCE_RENDER, ASYNC_RENDER, ATTR_KEY } from '../constants';\nimport options from '../options';\nimport { isFunction, clone, extend, empty } from '../util';\nimport { enqueueRender } from '../render-queue';\nimport { getNodeProps } from './index';\nimport { diff, mounts, diffLevel, flushMounts, removeOrphanedChildren, recollectNodeTree } from './diff';\nimport { isFunctionalComponent, buildFunctionalComponent } from './functional-component';\nimport { createComponent, collectComponent } from './component-recycler';\nimport { removeNode } from '../dom/index';\n\n\n/** Mark component as dirty and queue up a render.\n *\t@param {Component} component\n *\t@private\n */\nexport function triggerComponentRender(component) {\n\tif (!component._dirty) {\n\t\tcomponent._dirty = true;\n\t\tenqueueRender(component);\n\t}\n}\n\n\n\n/** Set a component's `props` (generally derived from JSX attributes).\n *\t@param {Object} props\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.renderSync=false]\tIf `true` and {@link options.syncComponentUpdates} is `true`, triggers synchronous rendering.\n *\t@param {boolean} [opts.render=true]\t\t\tIf `false`, no render will be triggered.\n */\nexport function setComponentProps(component, props, opts, context, mountAll) {\n\tlet b = component.base;\n\tif (component._disableRendering) return;\n\tcomponent._disableRendering = true;\n\n\tif ((component.__ref = props.ref)) delete props.ref;\n\tif ((component.__key = props.key)) delete props.key;\n\n\tif (empty(b) || mountAll) {\n\t\tif (component.componentWillMount) component.componentWillMount();\n\t}\n\telse if (component.componentWillReceiveProps) {\n\t\tcomponent.componentWillReceiveProps(props, context);\n\t}\n\n\tif (context && context!==component.context) {\n\t\tif (!component.prevContext) component.prevContext = component.context;\n\t\tcomponent.context = context;\n\t}\n\n\tif (!component.prevProps) component.prevProps = component.props;\n\tcomponent.props = props;\n\n\tcomponent._disableRendering = false;\n\n\tif (opts!==NO_RENDER) {\n\t\tif (opts===SYNC_RENDER || options.syncComponentUpdates!==false || !b) {\n\t\t\trenderComponent(component, SYNC_RENDER, mountAll);\n\t\t}\n\t\telse {\n\t\t\ttriggerComponentRender(component);\n\t\t}\n\t}\n\n\tif (component.__ref) component.__ref(component);\n}\n\n\n\n/** Render a Component, triggering necessary lifecycle events and taking High-Order Components into account.\n *\t@param {Component} component\n *\t@param {Object} [opts]\n *\t@param {boolean} [opts.build=false]\t\tIf `true`, component will build and store a DOM node if not already associated with one.\n *\t@private\n */\nexport function renderComponent(component, opts, mountAll) {\n\tif (component._disableRendering) return;\n\n\tlet skip, rendered,\n\t\tprops = component.props,\n\t\tstate = component.state,\n\t\tcontext = component.context,\n\t\tpreviousProps = component.prevProps || props,\n\t\tpreviousState = component.prevState || state,\n\t\tpreviousContext = component.prevContext || context,\n\t\tisUpdate = component.base,\n\t\tinitialBase = isUpdate || component.nextBase,\n\t\tinitialChildComponent = component._component;\n\n\t// if updating\n\tif (isUpdate) {\n\t\tcomponent.props = previousProps;\n\t\tcomponent.state = previousState;\n\t\tcomponent.context = previousContext;\n\t\tif (opts!==FORCE_RENDER\n\t\t\t&& component.shouldComponentUpdate\n\t\t\t&& component.shouldComponentUpdate(props, state, context) === false) {\n\t\t\tskip = true;\n\t\t}\n\t\telse if (component.componentWillUpdate) {\n\t\t\tcomponent.componentWillUpdate(props, state, context);\n\t\t}\n\t\tcomponent.props = props;\n\t\tcomponent.state = state;\n\t\tcomponent.context = context;\n\t}\n\n\tcomponent.prevProps = component.prevState = component.prevContext = component.nextBase = null;\n\tcomponent._dirty = false;\n\n\tif (!skip) {\n\t\tif (component.render) rendered = component.render(props, state, context);\n\n\t\t// context to pass to the child, can be updated via (grand-)parent component\n\t\tif (component.getChildContext) {\n\t\t\tcontext = extend(clone(context), component.getChildContext());\n\t\t}\n\n\t\twhile (isFunctionalComponent(rendered)) {\n\t\t\trendered = buildFunctionalComponent(rendered, context);\n\t\t}\n\n\t\tlet childComponent = rendered && rendered.nodeName,\n\t\t\ttoUnmount, base;\n\n\t\tif (isFunction(childComponent) && childComponent.prototype.render) {\n\t\t\t// set up high order component link\n\n\t\t\tlet inst = initialChildComponent,\n\t\t\t\tchildProps = getNodeProps(rendered);\n\n\t\t\tif (inst && inst.constructor===childComponent) {\n\t\t\t\tsetComponentProps(inst, childProps, SYNC_RENDER, context);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoUnmount = inst;\n\t\t\t\tinst = createComponent(childComponent, childProps, context);\n\t\t\t\tinst.nextBase = inst.nextBase || mountAll && initialBase;\n\t\t\t\tinst._parentComponent = component;\n\t\t\t\tcomponent._component = inst;\n\t\t\t\tsetComponentProps(inst, childProps, NO_RENDER, context);\n\t\t\t\trenderComponent(inst, SYNC_RENDER);\n\t\t\t}\n\n\t\t\tbase = inst.base;\n\t\t}\n\t\telse {\n\t\t\tlet cbase = initialBase;\n\n\t\t\t// destroy high order component link\n\t\t\ttoUnmount = initialChildComponent;\n\t\t\tif (toUnmount) {\n\t\t\t\tcbase = component._component = null;\n\t\t\t}\n\n\t\t\tif (initialBase || opts===SYNC_RENDER) {\n\t\t\t\tif (cbase) cbase._component = null;\n\t\t\t\tbase = diff(cbase, rendered, context, mountAll || !isUpdate, initialBase && initialBase.parentNode, true);\n\t\t\t}\n\t\t}\n\n\t\tif (initialBase && base!==initialBase) {\n\t\t\tlet baseParent = initialBase.parentNode;\n\t\t\tif (baseParent && base!==baseParent) {\n\t\t\t\tbaseParent.replaceChild(base, initialBase);\n\t\t\t}\n\n\t\t\tif (!toUnmount && component._parentComponent) {\n\t\t\t\tinitialBase._component = null;\n\t\t\t\trecollectNodeTree(initialBase);\n\t\t\t}\n\t\t}\n\n\t\tif (toUnmount) {\n\t\t\tunmountComponent(toUnmount, base!==initialBase);\n\t\t}\n\n\t\tcomponent.base = base;\n\t\tif (base) {\n\t\t\tlet componentRef = component,\n\t\t\t\tt = component;\n\t\t\twhile ((t=t._parentComponent)) { componentRef = t; }\n\t\t\tbase._component = componentRef;\n\t\t\tbase._componentConstructor = componentRef.constructor;\n\t\t}\n\t}\n\n\tif (!isUpdate || mountAll) {\n\t\tmounts.unshift(component);\n\t\tif (!diffLevel) flushMounts();\n\t}\n\telse if (!skip && component.componentDidUpdate) {\n\t\tcomponent.componentDidUpdate(previousProps, previousState, previousContext);\n\t}\n\n\tlet cb = component._renderCallbacks, fn;\n\tif (cb) while ( (fn = cb.pop()) ) fn.call(component);\n\n\treturn rendered;\n}\n\n\n\n/** Apply the Component referenced by a VNode to the DOM.\n *\t@param {Element} dom\tThe DOM node to mutate\n *\t@param {VNode} vnode\tA Component-referencing VNode\n *\t@returns {Element} dom\tThe created/mutated element\n *\t@private\n */\nexport function buildComponentFromVNode(dom, vnode, context, mountAll) {\n\tlet c = dom && dom._component,\n\t\toldDom = dom,\n\t\tisDirectOwner = c && dom._componentConstructor===vnode.nodeName,\n\t\tisOwner = isDirectOwner,\n\t\tprops = getNodeProps(vnode);\n\twhile (c && !isOwner && (c=c._parentComponent)) {\n\t\tisOwner = c.constructor===vnode.nodeName;\n\t}\n\n\tif (isOwner && (!mountAll || c._component)) {\n\t\tsetComponentProps(c, props, ASYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\t}\n\telse {\n\t\tif (c && !isDirectOwner) {\n\t\t\tunmountComponent(c, true);\n\t\t\tdom = oldDom = null;\n\t\t}\n\n\t\tc = createComponent(vnode.nodeName, props, context);\n\t\tif (dom && !c.nextBase) c.nextBase = dom;\n\t\tsetComponentProps(c, props, SYNC_RENDER, context, mountAll);\n\t\tdom = c.base;\n\n\t\tif (oldDom && dom!==oldDom) {\n\t\t\toldDom._component = null;\n\t\t\trecollectNodeTree(oldDom);\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n\n\n/** Remove a component from the DOM and recycle it.\n *\t@param {Element} dom\t\t\tA DOM node from which to unmount the given Component\n *\t@param {Component} component\tThe Component instance to unmount\n *\t@private\n */\nexport function unmountComponent(component, remove) {\n\t// console.log(`${remove?'Removing':'Unmounting'} component: ${component.constructor.name}`);\n\tlet base = component.base;\n\n\tcomponent._disableRendering = true;\n\n\tif (component.componentWillUnmount) component.componentWillUnmount();\n\n\tcomponent.base = null;\n\n\t// recursively tear down & recollect high-order component children:\n\tlet inner = component._component;\n\tif (inner) {\n\t\tunmountComponent(inner, remove);\n\t}\n\telse if (base) {\n\t\tif (base[ATTR_KEY] && base[ATTR_KEY].ref) base[ATTR_KEY].ref(null);\n\n\t\tcomponent.nextBase = base;\n\n\t\tif (remove) {\n\t\t\tremoveNode(base);\n\t\t\tcollectComponent(component);\n\t\t}\n\t\tremoveOrphanedChildren(base.childNodes, !remove);\n\t}\n\n\tif (component.__ref) component.__ref(null);\n\tif (component.componentDidUnmount) component.componentDidUnmount();\n}\n","import { FORCE_RENDER } from './constants';\nimport { extend, clone, isFunction } from './util';\nimport { createLinkedState } from './linked-state';\nimport { triggerComponentRender, renderComponent } from './vdom/component';\n\n/** Base Component class, for he ES6 Class method of creating Components\n *\t@public\n *\n *\t@example\n *\tclass MyFoo extends Component {\n *\t\trender(props, state) {\n *\t\t\treturn <div />;\n *\t\t}\n *\t}\n */\nexport function Component(props, context) {\n\t/** @private */\n\tthis._dirty = true;\n\t/** @public */\n\tthis._disableRendering = false;\n\t/** @public */\n\tthis.prevState = this.prevProps = this.prevContext = this.base = this.nextBase = this._parentComponent = this._component = this.__ref = this.__key = this._linkedStates = this._renderCallbacks = null;\n\t/** @public */\n\tthis.context = context;\n\t/** @type {object} */\n\tthis.props = props;\n\t/** @type {object} */\n\tthis.state = this.getInitialState && this.getInitialState() || {};\n}\n\n\nextend(Component.prototype, {\n\n\t/** Returns a `boolean` value indicating if the component should re-render when receiving the given `props` and `state`.\n\t *\t@param {object} nextProps\n\t *\t@param {object} nextState\n\t *\t@param {object} nextContext\n\t *\t@returns {Boolean} should the component re-render\n\t *\t@name shouldComponentUpdate\n\t *\t@function\n\t */\n\t// shouldComponentUpdate() {\n\t// \treturn true;\n\t// },\n\n\n\t/** Returns a function that sets a state property when called.\n\t *\tCalling linkState() repeatedly with the same arguments returns a cached link function.\n\t *\n\t *\tProvides some built-in special cases:\n\t *\t\t- Checkboxes and radio buttons link their boolean `checked` value\n\t *\t\t- Inputs automatically link their `value` property\n\t *\t\t- Event paths fall back to any associated Component if not found on an element\n\t *\t\t- If linked value is a function, will invoke it and use the result\n\t *\n\t *\t@param {string} key\t\t\t\tThe path to set - can be a dot-notated deep key\n\t *\t@param {string} [eventPath]\t\tIf set, attempts to find the new state value at a given dot-notated path within the object passed to the linkedState setter.\n\t *\t@returns {function} linkStateSetter(e)\n\t *\n\t *\t@example Update a \"text\" state value when an input changes:\n\t *\t\t<input onChange={ this.linkState('text') } />\n\t *\n\t *\t@example Set a deep state value on click\n\t *\t\t<button onClick={ this.linkState('touch.coords', 'touches.0') }>Tap</button\n\t */\n\tlinkState(key, eventPath) {\n\t\tlet c = this._linkedStates || (this._linkedStates = {}),\n\t\t\tcacheKey = key + '|' + eventPath;\n\t\treturn c[cacheKey] || (c[cacheKey] = createLinkedState(this, key, eventPath));\n\t},\n\n\n\t/** Update component state by copying properties from `state` to `this.state`.\n\t *\t@param {object} state\t\tA hash of state properties to update with new values\n\t */\n\tsetState(state, callback) {\n\t\tlet s = this.state;\n\t\tif (!this.prevState) this.prevState = clone(s);\n\t\textend(s, isFunction(state) ? state(s, this.props) : state);\n\t\tif (callback) (this._renderCallbacks = (this._renderCallbacks || [])).push(callback);\n\t\ttriggerComponentRender(this);\n\t},\n\n\n\t/** Immediately perform a synchronous re-render of the component.\n\t *\t@private\n\t */\n\tforceUpdate() {\n\t\trenderComponent(this, FORCE_RENDER);\n\t},\n\n\n\t/** Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n\t *\tVirtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n\t *\t@param {object} props\t\tProps (eg: JSX attributes) received from parent element/component\n\t *\t@param {object} state\t\tThe component's current state\n\t *\t@param {object} context\t\tContext object (if a parent component has provided context)\n\t *\t@returns VNode\n\t */\n\trender() {\n\t\treturn null;\n\t}\n\n});\n","import { diff } from './vdom/diff';\n\n/** Render JSX into a `parent` Element.\n *\t@param {VNode} vnode\t\tA (JSX) VNode to render\n *\t@param {Element} parent\t\tDOM element to render into\n *\t@param {Element} [merge]\tAttempt to re-use an existing DOM tree rooted at `merge`\n *\t@public\n *\n *\t@example\n *\t// render a div into <body>:\n *\trender(<div id=\"hello\">hello!</div>, document.body);\n *\n *\t@example\n *\t// render a \"Thing\" component into #foo:\n *\tconst Thing = ({ name }) => <span>{ name }</span>;\n *\trender(<Thing name=\"one\" />, document.querySelector('#foo'));\n */\nexport function render(vnode, parent, merge) {\n\treturn diff(merge, vnode, {}, false, parent);\n}\n","import PropTypes from 'proptypes';\nimport { render as preactRender, cloneElement as preactCloneElement, h, Component as PreactComponent, options } from 'preact';\n\nconst version = '15.1.0'; // trick libraries to think we are react\n\nconst ELEMENTS = 'a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan'.split(' ');\n\nconst REACT_ELEMENT_TYPE = (typeof Symbol === 'function' && Symbol.for && Symbol.for('react.element')) || 0xeac7;\n\n// don't autobind these methods since they already have guaranteed context.\nconst AUTOBIND_BLACKLIST = {\n\tconstructor: 1,\n\trender: 1,\n\tshouldComponentUpdate: 1,\n\tcomponentWillReceiveProps: 1,\n\tcomponentWillUpdate: 1,\n\tcomponentDidUpdate: 1,\n\tcomponentWillMount: 1,\n\tcomponentDidMount: 1,\n\tcomponentWillUnmount: 1,\n\tcomponentDidUnmount: 1\n};\n\n\nconst BYPASS_HOOK = {};\n\n/*global process*/\nconst DEV = typeof process!=='undefined' && process.env && process.env.NODE_ENV!=='production';\n\n// a component that renders nothing. Used to replace components for unmountComponentAtNode.\nconst EmptyComponent = () => null;\n\n\n\n// make react think we're react.\nlet VNode = h('').constructor;\nVNode.prototype.$$typeof = REACT_ELEMENT_TYPE;\n\nObject.defineProperty(VNode.prototype, 'type', {\n\tget() { return this.nodeName; },\n\tset(v) { this.nodeName = v; },\n\tconfigurable:true\n});\n\nObject.defineProperty(VNode.prototype, 'props', {\n\tget() { return this.attributes; },\n\tset(v) { this.attributes = v; },\n\tconfigurable:true\n});\n\n\nlet oldVnodeHook = options.vnode;\noptions.vnode = vnode => {\n\tlet a = vnode.attributes,\n\t\ttag = vnode.nodeName;\n\tif (!a) a = vnode.attributes = {};\n\n\tif (typeof tag==='function') {\n\t\tlet isCompat = tag[COMPONENT_WRAPPER_KEY]===true,\n\t\t\tp = tag;\n\t\tif (!isCompat) {\n\t\t\tdo {\n\t\t\t\tif (p instanceof Component) {\n\t\t\t\t\tisCompat = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} while ((p=p.prototype) && p!==Function && p!==Object);\n\t\t}\n\n\t\tif (isCompat) {\n\t\t\tnormalizeVNode(vnode);\n\n\t\t\t// apply defaultProps\n\t\t\tif (tag.defaultProps) {\n\t\t\t\tfor (let i in tag.defaultProps) {\n\t\t\t\t\tif (tag.defaultProps.hasOwnProperty(i) && a[i]==null) {\n\t\t\t\t\t\ta[i] = tag.defaultProps[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// clone if needed (fixes #105):\n\tif (Object.isExtensible && !Object.isExtensible(a)) {\n\t\ta = extend({}, a, true);\n\t}\n\ta.children = vnode.children;\n\tif (oldVnodeHook) oldVnodeHook(vnode);\n};\n\n\n\n// proxy render() since React returns a Component reference.\nfunction render(vnode, parent, callback) {\n\tlet prev = parent._preactCompatRendered;\n\n\t// ignore impossible previous renders\n\tif (prev && prev.parentNode!==parent) prev = null;\n\n\t// default to first Element child\n\tif (!prev) prev = parent.children[0];\n\n\t// remove unaffected siblings\n\tfor (let i=parent.childNodes.length; i--; ) {\n\t\tif (parent.childNodes[i]!==prev) {\n\t\t\tparent.removeChild(parent.childNodes[i]);\n\t\t}\n\t}\n\n\tlet out = preactRender(vnode, parent, prev);\n\tparent._preactCompatRendered = out;\n\tif (typeof callback==='function') callback();\n\treturn out && out._component || out.base;\n}\n\n\nclass ContextProvider {\n\tgetChildContext() {\n\t\treturn this.props.context;\n\t}\n\trender(props) {\n\t\treturn props.children[0];\n\t}\n}\n\nfunction renderSubtreeIntoContainer(parentComponent, vnode, container, callback) {\n\tlet wrap = h(ContextProvider, { context: parentComponent.context }, vnode);\n\tlet c = render(wrap, container);\n\tif (callback) callback(c);\n\treturn c;\n}\n\n\nfunction unmountComponentAtNode(container) {\n\tlet existing = container._preactCompatRendered;\n\tif (existing && existing.parentNode===container) {\n\t\tpreactRender(h(EmptyComponent), container, existing);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n\n\nconst ARR = [];\n\n// This API is completely unnecessary for Preact, so it's basically passthrough.\nlet Children = {\n\tmap(children, fn, ctx) {\n\t\tchildren = Children.toArray(children);\n\t\tif (ctx && ctx!==children) fn = fn.bind(ctx);\n\t\treturn children.map(fn);\n\t},\n\tforEach(children, fn, ctx) {\n\t\tchildren = Children.toArray(children);\n\t\tif (ctx && ctx!==children) fn = fn.bind(ctx);\n\t\tchildren.forEach(fn);\n\t},\n\tcount(children) {\n\t\tchildren = Children.toArray(children);\n\t\treturn children.length;\n\t},\n\tonly(children) {\n\t\tchildren = Children.toArray(children);\n\t\tif (children.length!==1) throw new Error('Children.only() expects only one child.');\n\t\treturn children[0];\n\t},\n\ttoArray(children) {\n\t\treturn Array.isArray && Array.isArray(children) ? children : ARR.concat(children);\n\t}\n};\n\n\n/** Track current render() component for ref assignment */\nlet currentComponent;\n\n\nfunction createFactory(type) {\n\treturn createElement.bind(null, type);\n}\n\n\nlet DOM = {};\nfor (let i=ELEMENTS.length; i--; ) {\n\tDOM[ELEMENTS[i]] = createFactory(ELEMENTS[i]);\n}\n\nfunction upgradeToVNodes(arr, offset) {\n\tfor (let i=offset || 0; i<arr.length; i++) {\n\t\tlet obj = arr[i];\n\t\tif (Array.isArray(obj)) {\n\t\t\tupgradeToVNodes(obj);\n\t\t}\n\t\telse if (obj && typeof obj==='object' && !isValidElement(obj) && ((obj.props && obj.type) || (obj.attributes && obj.nodeName) || obj.children)) {\n\t\t\tarr[i] = createElement(obj.type || obj.nodeName, obj.props || obj.attributes, obj.children);\n\t\t}\n\t}\n}\n\nfunction isStatelessComponent(c) {\n\treturn typeof c==='function' && !(c.prototype && c.prototype.render);\n}\n\n\nconst COMPONENT_WRAPPER_KEY = typeof Symbol!=='undefined' ? Symbol.for('__preactCompatWrapper') : '__preactCompatWrapper';\n\n// wraps stateless functional components in a PropTypes validator\nfunction wrapStatelessComponent(WrappedComponent) {\n\treturn function StatelessComponent(props, context) {\n\t\tpropsHook.call(WrappedComponent, props, context);\n\t\treturn WrappedComponent(props, context);\n\t};\n}\n\n\nfunction statelessComponentHook(Ctor) {\n\tlet Wrapped = Ctor[COMPONENT_WRAPPER_KEY];\n\tif (Wrapped) return Wrapped===true ? Ctor : Wrapped;\n\n\tWrapped = wrapStatelessComponent(Ctor);\n\n\tObject.defineProperty(Wrapped, COMPONENT_WRAPPER_KEY, { configurable:true, value:true });\n\tWrapped.displayName = Ctor.displayName;\n\tWrapped.propTypes = Ctor.propTypes;\n\tWrapped.defaultProps = Ctor.defaultProps;\n\n\tObject.defineProperty(Ctor, COMPONENT_WRAPPER_KEY, { configurable:true, value:Wrapped });\n\n\treturn Wrapped;\n}\n\n\nfunction createElement(...args) {\n\tupgradeToVNodes(args, 2);\n\treturn normalizeVNode(h(...args));\n}\n\n\nfunction normalizeVNode(vnode) {\n\tapplyClassName(vnode);\n\n\tif (isStatelessComponent(vnode.nodeName)) {\n\t\tvnode.nodeName = statelessComponentHook(vnode.nodeName);\n\t}\n\n\tlet ref = vnode.attributes && vnode.attributes.ref,\n\t\ttype = ref && typeof ref;\n\tif (currentComponent && (type==='string' || type==='number')) {\n\t\tvnode.attributes.ref = createStringRefProxy(ref, currentComponent);\n\t}\n\n\tapplyEventNormalization(vnode);\n\n\treturn vnode;\n}\n\n\nfunction cloneElement(element, props, ...children) {\n\tlet node = h(\n\t\telement.nodeName || element.type,\n\t\telement.attributes || element.props,\n\t\telement.children || element.props.children\n\t);\n\treturn normalizeVNode(preactCloneElement(node, props, ...children));\n}\n\n\nfunction isValidElement(element) {\n\treturn element && ((element instanceof VNode) || element.$$typeof===REACT_ELEMENT_TYPE);\n}\n\n\nfunction createStringRefProxy(name, component) {\n\treturn component._refProxies[name] || (component._refProxies[name] = resolved => {\n\t\tif (component && component.refs) {\n\t\t\tcomponent.refs[name] = resolved;\n\t\t\tif (resolved===null) {\n\t\t\t\tdelete component._refProxies[name];\n\t\t\t\tcomponent = null;\n\t\t\t}\n\t\t}\n\t});\n}\n\n\nfunction applyEventNormalization({ nodeName, attributes }) {\n\tif (!attributes || typeof nodeName!=='string') return;\n\tlet props = {};\n\tfor (let i in attributes) {\n\t\tprops[i.toLowerCase()] = i;\n\t}\n\tif (props.onchange) {\n\t\tnodeName = nodeName.toLowerCase();\n\t\tlet attr = nodeName==='input' && String(attributes.type).toLowerCase()==='checkbox' ? 'onclick' : 'oninput',\n\t\t\tnormalized = props[attr] || attr;\n\t\tif (!attributes[normalized]) {\n\t\t\tattributes[normalized] = multihook(attributes[props[attr]], attributes[props.onchange]);\n\t\t}\n\t}\n}\n\n\nfunction applyClassName({ attributes }) {\n\tif (!attributes) return;\n\tlet cl = attributes.className || attributes.class;\n\tif (cl) attributes.className = cl;\n}\n\n\nfunction extend(base, props, all) {\n\tfor (let key in props) {\n\t\tif (all===true || props[key]!=null) {\n\t\t\tbase[key] = props[key];\n\t\t}\n\t}\n\treturn base;\n}\n\n\nlet findDOMNode = component => component && component.base || component;\n\n\nfunction F(){}\n\nfunction createClass(obj) {\n\tlet mixins = obj.mixins && collateMixins(obj.mixins);\n\n\tfunction cl(props, context) {\n\t\textend(this, obj);\n\t\tif (mixins) applyMixins(this, mixins);\n\t\tComponent.call(this, props, context, BYPASS_HOOK);\n\t\tbindAll(this);\n\t\tnewComponentHook.call(this, props, context);\n\t}\n\n\tif (obj.statics) {\n\t\textend(cl, obj.statics);\n\t}\n\tif (obj.propTypes) {\n\t\tcl.propTypes = obj.propTypes;\n\t}\n\tif (obj.defaultProps) {\n\t\tcl.defaultProps = obj.defaultProps;\n\t}\n\tif (obj.getDefaultProps) {\n\t\tcl.defaultProps = obj.getDefaultProps();\n\t}\n\n\tF.prototype = Component.prototype;\n\tcl.prototype = new F();\n\tcl.prototype.constructor = cl;\n\n\tcl.displayName = obj.displayName || 'Component';\n\n\treturn cl;\n}\n\n\n// Flatten an Array of mixins to a map of method name to mixin implementations\nfunction collateMixins(mixins) {\n\tlet keyed = {};\n\tfor (let i=0; i<mixins.length; i++) {\n\t\tlet mixin = mixins[i];\n\t\tfor (let key in mixin) {\n\t\t\tif (mixin.hasOwnProperty(key) && typeof mixin[key]==='function') {\n\t\t\t\t(keyed[key] || (keyed[key]=[])).push(mixin[key]);\n\t\t\t}\n\t\t}\n\t}\n\treturn keyed;\n}\n\n\n// apply a mapping of Arrays of mixin methods to a component instance\nfunction applyMixins(inst, mixins) {\n\tfor (let key in mixins) if (mixins.hasOwnProperty(key)) {\n\t\tinst[key] = multihook(...mixins[key].concat(inst[key] || key));\n\t}\n}\n\n\nfunction bindAll(ctx) {\n\tfor (let i in ctx) {\n\t\tlet v = ctx[i];\n\t\tif (typeof v==='function' && !v.__bound && !AUTOBIND_BLACKLIST.hasOwnProperty(i)) {\n\t\t\t(ctx[i] = v.bind(ctx)).__bound = true;\n\t\t}\n\t}\n}\n\n\nfunction callMethod(ctx, m, args) {\n\tif (typeof m==='string') {\n\t\tm = ctx.constructor.prototype[m];\n\t}\n\tif (typeof m==='function') {\n\t\treturn m.apply(ctx, args);\n\t}\n}\n\nfunction multihook() {\n\tlet hooks = arguments;\n\treturn function() {\n\t\tlet ret;\n\t\tfor (let i=0; i<hooks.length; i++) {\n\t\t\tlet r = callMethod(this, hooks[i], arguments);\n\t\t\tif (r!==undefined) ret = r;\n\t\t}\n\t\treturn ret;\n\t};\n}\n\n\nfunction newComponentHook(props, context) {\n\tpropsHook.call(this, props, context);\n\tthis.componentWillReceiveProps = multihook(propsHook, this.componentWillReceiveProps || 'componentWillReceiveProps');\n\tthis.render = multihook(propsHook, beforeRender, this.render || 'render', afterRender);\n}\n\n\nfunction propsHook(props, context) {\n\tif (!props) return;\n\n\t// React annoyingly special-cases single children, and some react components are ridiculously strict about this.\n\tlet c = props.children;\n\tif (Array.isArray(c) && c.length===1) {\n\t\tprops.children = c[0];\n\n\t\t// but its totally still going to be an Array.\n\t\tif (props.children && typeof props.children==='object') {\n\t\t\tprops.children.length = 1;\n\t\t\tprops.children[0] = props.children;\n\t\t}\n\t}\n\n\t// add proptype checking\n\tif (DEV) {\n\t\tlet ctor = typeof this==='function' ? this : this.constructor,\n\t\t\tpropTypes = this.propTypes || ctor.propTypes;\n\t\tif (propTypes) {\n\t\t\tfor (let prop in propTypes) {\n\t\t\t\tif (propTypes.hasOwnProperty(prop) && typeof propTypes[prop]==='function') {\n\t\t\t\t\tconst displayName = this.displayName || ctor.name;\n\t\t\t\t\tlet err = propTypes[prop](props, prop, displayName, 'prop');\n\t\t\t\t\tif (err) console.error(new Error(err.message || err));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction beforeRender(props) {\n\tcurrentComponent = this;\n}\n\nfunction afterRender() {\n\tif (currentComponent===this) {\n\t\tcurrentComponent = null;\n\t}\n}\n\n\n\nfunction Component(props, context, opts) {\n\tPreactComponent.call(this, props, context);\n\tthis.refs = {};\n\tthis._refProxies = {};\n\tif (opts!==BYPASS_HOOK) {\n\t\tnewComponentHook.call(this, props, context);\n\t}\n}\nComponent.prototype = new PreactComponent();\nextend(Component.prototype, {\n\tconstructor: Component,\n\n\tisReactComponent: {},\n\n\tgetDOMNode() {\n\t\treturn this.base;\n\t},\n\n\tisMounted() {\n\t\treturn !!this.base;\n\t}\n});\n\n\n\nexport {\n\tversion,\n\tDOM,\n\tPropTypes,\n\tChildren,\n\trender,\n\tcreateClass,\n\tcreateFactory,\n\tcreateElement,\n\tcloneElement,\n\tisValidElement,\n\tfindDOMNode,\n\tunmountComponentAtNode,\n\tComponent,\n\trenderSubtreeIntoContainer as unstable_renderSubtreeIntoContainer\n};\n\nexport default {\n\tversion,\n\tDOM,\n\tPropTypes,\n\tChildren,\n\trender,\n\tcreateClass,\n\tcreateFactory,\n\tcreateElement,\n\tcloneElement,\n\tisValidElement,\n\tfindDOMNode,\n\tunmountComponentAtNode,\n\tComponent,\n\tunstable_renderSubtreeIntoContainer: renderSubtreeIntoContainer\n};\n","export function join (...paths) {\n    return paths.join('/').replace(/([^:])\\/+/g, '$1/');\n}\n","import 'whatwg-fetch';\n\nexport function inject (Promise) {\n    function json (path) {\n        return fetch(path, {\n            mode: 'cors'\n        }).then(resp => {\n            return resp.ok ? resp.json() : Promise.reject(new Error('fetch error: ' + resp.statusText));\n        });\n    }\n\n    function jsonp (path) {\n        return new Promise(function(resolve, reject) {\n            const jsonpCallback = 'jp_' + Math.floor((Math.random() * 100)) + new Date().getTime();\n            const jsonpPath = [path, 'callback=' + jsonpCallback].join(path.indexOf('?') === -1 ? '?' : '&');\n            window[jsonpCallback] = resolve;\n            const script = document.createElement('script');\n            script.src = jsonpPath;\n            script.onerror = function() {\n                reject(new Error('JSONP network error on ' + jsonpPath));\n            };\n            document.head.appendChild(script);\n        });\n    }\n\n    return { json, jsonp };\n}\n","import { inject } from '../utils/net';\nimport mediator from '../utils/mediator';\nimport { join } from '../utils/url';\n\nexport function create ({\n    apiHost,\n    net,\n    Promise\n}) {\n    const defaultNet = inject(Promise);\n    const {json = defaultNet.json, jsonp = defaultNet.jsonp} = net;\n\n    function commentCount (...ids) {\n        const url = join(apiHost, 'getCommentCounts' + '?short-urls=' + ids.join(','));\n        return json(url).catch(ex => {\n            mediator.emit('error', 'comments-count', ex);\n            throw ex;\n        });\n    }\n\n    function userProfile (id = 'me') {\n        const url = join(apiHost, '/profile/' + id);\n        return jsonp(url)\n        .then(response => {\n            if (response.status !== 'ok') {\n                throw new Error('Invalid user profile status: ' + response.status);\n            } else {\n                return response.userProfile;\n            }\n        })\n        .catch(ex => {\n            mediator.emit('error', 'user-profile', ex);\n            throw ex;\n        });\n    }\n\n    return {\n        commentCount,\n        userProfile\n    };\n}\n","import { render } from 'react-dom';\nimport Discussion from './model/discussion';\nimport mediator from './utils/mediator';\nimport { create as createApi } from './net/discussion-api.js';\n\nexport default function create ({\n    /* Base host for discussion api */\n    apiHost,\n    /* Base host for avatar images */\n    avatarImagesHost,\n    /* Is the discussion closed for comments */\n    closed,\n    /* Discussion ID */\n    discussionId,\n    /* Element in which the discussion frontend is rendered */\n    element,\n    /* Custom net module, exports `json` and `jsonp` methods */\n    net = {},\n    /* Base path for profile service e.g. signin, register */\n    profileUrl,\n    /* Client id to add to profile links e.g. signin, register */\n    profileClientId,\n    /* User information, if null, it tries to get it from discussion API */\n    user,\n    /* Does the user have a valid guardian user cookie? If so it'll get the profile from API */\n    userFromCookie,\n    /* Dependency injection: Promise */\n    Promise = window.Promise\n}) {\n    const api = createApi({ apiHost, net, Promise });\n\n    const component = (\n        <Discussion\n            id={discussionId}\n            api={api}\n            avatarImagesHost={avatarImagesHost}\n            profileUrl={profileUrl}\n            profileClientId={profileClientId}\n            closed={closed}\n            user={user}\n            userFromCookie={userFromCookie}\n        />\n    );\n\n    return new Promise(resolve => {\n        render(\n            component,\n            element,\n            () => resolve(mediator)\n        );\n    });\n}\n","/** Global options\n *\t@public\n *\t@namespace options {Object}\n */\nexport default {\n\n\t/** If `true`, `prop` changes trigger synchronous component updates.\n\t *\t@name syncComponentUpdates\n\t *\t@type Boolean\n\t *\t@default true\n\t */\n\t//syncComponentUpdates: true,\n\n\t/** Processes all created VNodes.\n\t *\t@param {VNode} vnode\tA newly-created VNode to normalize/process\n\t */\n\t//vnode(vnode) { }\n};\n","module.exports = {};\n","// render modes\n\nexport const NO_RENDER = 0;\nexport const SYNC_RENDER = 1;\nexport const FORCE_RENDER = 2;\nexport const ASYNC_RENDER = 3;\n\nexport const EMPTY = {};\n\nexport const ATTR_KEY = typeof Symbol!=='undefined' ? Symbol.for('preactattr') : '__preactattr_';\n\n// DOM properties that should NOT have \"px\" added when numeric\nexport const NON_DIMENSION_PROPS = {\n\tboxFlex:1, boxFlexGroup:1, columnCount:1, fillOpacity:1, flex:1, flexGrow:1,\n\tflexPositive:1, flexShrink:1, flexNegative:1, fontWeight:1, lineClamp:1, lineHeight:1,\n\topacity:1, order:1, orphans:1, strokeOpacity:1, widows:1, zIndex:1, zoom:1\n};\n\n// DOM event types that do not bubble and should be attached via useCapture\nexport const NON_BUBBLING_EVENTS = { blur:1, error:1, focus:1, load:1, resize:1, scroll:1 };\n","import styles from './comment-count.css';\n\nconst CommentCount = ({ count }) => {\n    if (count) {\n        return (\n            <h2 className=\"container__meta__title\">\n                comments <span className={styles.count}>({count})</span>\n            </h2>\n        );\n    } else {\n        return <h2 className=\"container__meta__title\">comments</h2>;\n    }\n};\n\nCommentCount.propTypes = {\n    count: React.PropTypes.number\n};\n\nexport default CommentCount;\n","import styles from './avatar.css';\nimport styleHelpers from '../ui/styles/helpers.css';\nimport { join } from '../utils/url';\n\nconst Avatar = function({\n    avatarImagesHost,\n    displayName,\n    userId\n}) {\n    const avatarSrc = join(avatarImagesHost, 'user/', userId || 'undefined');\n\n    return (\n        <div className={styles.container}>\n            <span className={styles.avatarWrapper}>\n                <img className={styles.avatarImage} alt=\"\" src={avatarSrc} />\n            </span>\n            <div className={styleHelpers.borderBox}>\n                <span className={styles.label}>Signed in as</span>\n                {' '}\n                <span className={styles.author}>{displayName}</span>\n            </div>\n        </div>\n    );\n};\n\nAvatar.propTypes = {\n    avatarImagesHost: React.PropTypes.string.isRequired,\n    displayName: React.PropTypes.string.isRequired,\n    userId: React.PropTypes.string.isRequired,\n};\n\nexport default Avatar;\n","import { user } from '../model/proptypes';\nimport styleHelpers from '../ui/styles/helpers.css';\nimport Avatar from '../ui/avatar';\n\nconst Identity = function({\n    anonymous,\n    avatarImagesHost,\n    closed,\n    loading,\n    profile,\n    profileUrl,\n    profileClientId\n}) {\n    if (loading) {\n        // While loading don't show anything, it conflicts with what's rendered by frontend\n        return null;\n    } else if (anonymous || !profile) {\n        const signIn = profileUrl + '/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN' + (profileClientId ? '&clientId=' + profileClientId : '');\n        const register = profileUrl + '/register?INTCMP=DOTCOM_COMMENTS_REG' + (profileClientId ? '&clientId=' + profileClientId : '');\n        return (\n            <p className=\"container__meta__item\">\n                <a className={styleHelpers.underline} href={signIn}>Sign in</a>\n                {' '}or{' '}\n                <a className={styleHelpers.underline} href={register}>create your Guardian account</a>\n                {' '}to join the discussion.\n            </p>\n        );\n    } else if (closed) {\n        return (\n            <p className=\"container__meta__item\">\n                This discussion is closed for comments.\n            </p>\n        );\n    } else if ((profile.privateFields || {}).canPostComment === false) {\n        return (\n            <p className={['container__meta__item', styleHelpers.error].join(' ')}>\n                Commenting has been disabled for this account (<a href=\"/community-faqs#321a\">why?</a>)\n            </p>\n        );\n    } else {\n        return (\n            <Avatar avatarImagesHost={avatarImagesHost} userId={profile.userId} displayName={profile.displayName} />\n        );\n    }\n};\n\nIdentity.propTypes = {\n    anonymous: React.PropTypes.bool,\n    avatarImagesHost: React.PropTypes.string.isRequired,\n    closed: React.PropTypes.bool,\n    loading: React.PropTypes.bool.isRequired,\n    profile: user,\n    profileUrl: React.PropTypes.string.isRequired,\n    profileClientId: React.PropTypes.string,\n};\n\nexport default Identity;\n","import CommentCount from '../ui/comment-count';\nimport Identity from '../ui/identity';\nimport { user } from '../model/proptypes';\n\nconst DiscussionView = function({\n    anonymous,\n    avatarImagesHost,\n    children,\n    closed,\n    commentsCount,\n    loading,\n    profile,\n    profileUrl,\n    profileClientId\n}) {\n    return (\n        <div className=\"container__meta\">\n            <CommentCount count={commentsCount} />\n            <Identity\n                anonymous={anonymous}\n                avatarImagesHost={avatarImagesHost}\n                closed={closed}\n                loading={loading}\n                profile={profile}\n                profileUrl={profileUrl}\n                profileClientId={profileClientId}\n            />\n            {children}\n        </div>\n    );\n};\n\nDiscussionView.propTypes = {\n    anonymous: React.PropTypes.bool,\n    avatarImagesHost: React.PropTypes.string.isRequired,\n    children: React.PropTypes.any,\n    closed: React.PropTypes.bool,\n    commentsCount: React.PropTypes.number,\n    id: React.PropTypes.string,\n    loading: React.PropTypes.bool.isRequired,\n    profile: user,\n    profileUrl: React.PropTypes.string.isRequired,\n    profileClientId: React.PropTypes.string,\n};\n\nexport default DiscussionView;\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\n","import EventEmitter from 'tiny-emitter';\n\nexport default new EventEmitter();\n","import DiscussionView from '../ui/discussion-view';\nimport mediator from '../utils/mediator';\nimport { user } from '../model/proptypes';\n\nclass Discussion extends React.Component {\n    constructor (props) {\n        super(props);\n        this.state = {\n            anonymous: true,\n            commentsCount: 0,\n            loading: true,\n            profile: null\n        };\n        this.api = this.props.api;\n    }\n\n    componentDidMount () {\n        this.getCommentCount();\n        this.getUser();\n    }\n\n    getCommentCount () {\n        const { id } = this.props;\n\n        this.api.commentCount(id)\n        .then(counts => {\n            const value = counts[id] || 0;\n            this.setState({ commentsCount: value }, () => {\n                mediator.emit('comment-count', value);\n            });\n        });\n    }\n\n    getUser () {\n        const { user, userFromCookie } = this.props;\n        if (userFromCookie) {\n            this.api.userProfile().then((profile) => {\n                this.setState({ profile: profile, anonymous: false , loading: false});\n            });\n        } else if (user) {\n            this.setState({ profile: user, anonymous: false, loading: false });\n        } else {\n            this.setState({ anonymous: true, loading: false });\n        }\n    }\n\n    whenLoaded (condition, component) {\n        // Return the component only when the state is loaded and the condition is met\n        if (condition && this.state.loading === false) {\n            return component;\n        }\n    }\n\n    render () {\n        const {\n            avatarImagesHost,\n            id,\n            closed,\n            profileUrl,\n            profileClientId\n        } = this.props;\n\n        return (\n            <DiscussionView\n                {...this.state}\n                avatarImagesHost={avatarImagesHost}\n                id={id}\n                closed={closed}\n                profileUrl={profileUrl}\n                profileClientId={profileClientId}\n            >\n            </DiscussionView>\n        );\n    }\n}\n\nDiscussion.propTypes = {\n    id: React.PropTypes.string.isRequired,\n    api: React.PropTypes.shape({\n        commentCount: React.PropTypes.func.isRequired,\n        userProfile: React.PropTypes.func.isRequired\n    }).isRequired,\n    avatarImagesHost: React.PropTypes.string.isRequired,\n    profileUrl: React.PropTypes.string.isRequired,\n    profileClientId: React.PropTypes.string,\n    user: user,\n    userFromCookie: React.PropTypes.bool,\n    closed: React.PropTypes.bool.isRequired\n};\n\nexport default Discussion;\n","(function(self) {\n  'use strict';\n\n  if (self.fetch) {\n    return\n  }\n\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\n      try {\n        new Blob()\n        return true\n      } catch(e) {\n        return false\n      }\n    })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name)\n    }\n    if (/[^a-z0-9\\-#$%&'*+.\\^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value)\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift()\n        return {done: value === undefined, value: value}\n      }\n    }\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      }\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {}\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value)\n      }, this)\n\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name])\n      }, this)\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name)\n    value = normalizeValue(value)\n    var list = this.map[name]\n    if (!list) {\n      list = []\n      this.map[name] = list\n    }\n    list.push(value)\n  }\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)]\n  }\n\n  Headers.prototype.get = function(name) {\n    var values = this.map[normalizeName(name)]\n    return values ? values[0] : null\n  }\n\n  Headers.prototype.getAll = function(name) {\n    return this.map[normalizeName(name)] || []\n  }\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  }\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = [normalizeValue(value)]\n  }\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    Object.getOwnPropertyNames(this.map).forEach(function(name) {\n      this.map[name].forEach(function(value) {\n        callback.call(thisArg, value, name, this)\n      }, this)\n    }, this)\n  }\n\n  Headers.prototype.keys = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push(name) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.values = function() {\n    var items = []\n    this.forEach(function(value) { items.push(value) })\n    return iteratorFor(items)\n  }\n\n  Headers.prototype.entries = function() {\n    var items = []\n    this.forEach(function(value, name) { items.push([name, value]) })\n    return iteratorFor(items)\n  }\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result)\n      }\n      reader.onerror = function() {\n        reject(reader.error)\n      }\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader()\n    reader.readAsArrayBuffer(blob)\n    return fileReaderReady(reader)\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader()\n    reader.readAsText(blob)\n    return fileReaderReady(reader)\n  }\n\n  function Body() {\n    this.bodyUsed = false\n\n    this._initBody = function(body) {\n      this._bodyInit = body\n      if (typeof body === 'string') {\n        this._bodyText = body\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString()\n      } else if (!body) {\n        this._bodyText = ''\n      } else if (support.arrayBuffer && ArrayBuffer.prototype.isPrototypeOf(body)) {\n        // Only support ArrayBuffers for POST method.\n        // Receiving ArrayBuffers happens via Blobs, instead.\n      } else {\n        throw new Error('unsupported BodyInit type')\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8')\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type)\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n        }\n      }\n    }\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      }\n\n      this.arrayBuffer = function() {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n\n      this.text = function() {\n        var rejected = consumed(this)\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return readBlobAsText(this._bodyBlob)\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as text')\n        } else {\n          return Promise.resolve(this._bodyText)\n        }\n      }\n    } else {\n      this.text = function() {\n        var rejected = consumed(this)\n        return rejected ? rejected : Promise.resolve(this._bodyText)\n      }\n    }\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      }\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    }\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase()\n    return (methods.indexOf(upcased) > -1) ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {}\n    var body = options.body\n    if (Request.prototype.isPrototypeOf(input)) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url\n      this.credentials = input.credentials\n      if (!options.headers) {\n        this.headers = new Headers(input.headers)\n      }\n      this.method = input.method\n      this.mode = input.mode\n      if (!body) {\n        body = input._bodyInit\n        input.bodyUsed = true\n      }\n    } else {\n      this.url = input\n    }\n\n    this.credentials = options.credentials || this.credentials || 'omit'\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers)\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET')\n    this.mode = options.mode || this.mode || null\n    this.referrer = null\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body)\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this)\n  }\n\n  function decode(body) {\n    var form = new FormData()\n    body.trim().split('&').forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n    return form\n  }\n\n  function headers(xhr) {\n    var head = new Headers()\n    var pairs = (xhr.getAllResponseHeaders() || '').trim().split('\\n')\n    pairs.forEach(function(header) {\n      var split = header.trim().split(':')\n      var key = split.shift().trim()\n      var value = split.join(':').trim()\n      head.append(key, value)\n    })\n    return head\n  }\n\n  Body.call(Request.prototype)\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {}\n    }\n\n    this.type = 'default'\n    this.status = options.status\n    this.ok = this.status >= 200 && this.status < 300\n    this.statusText = options.statusText\n    this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)\n    this.url = options.url || ''\n    this._initBody(bodyInit)\n  }\n\n  Body.call(Response.prototype)\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  }\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''})\n    response.type = 'error'\n    return response\n  }\n\n  var redirectStatuses = [301, 302, 303, 307, 308]\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  }\n\n  self.Headers = Headers\n  self.Request = Request\n  self.Response = Response\n\n  self.fetch = function(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request\n      if (Request.prototype.isPrototypeOf(input) && !init) {\n        request = input\n      } else {\n        request = new Request(input, init)\n      }\n\n      var xhr = new XMLHttpRequest()\n\n      function responseURL() {\n        if ('responseURL' in xhr) {\n          return xhr.responseURL\n        }\n\n        // Avoid security warnings on getResponseHeader when not allowed by CORS\n        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\n          return xhr.getResponseHeader('X-Request-URL')\n        }\n\n        return\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: headers(xhr),\n          url: responseURL()\n        }\n        var body = 'response' in xhr ? xhr.response : xhr.responseText\n        resolve(new Response(body, options))\n      }\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'))\n      }\n\n      xhr.open(request.method, request.url, true)\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob'\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n    })\n  }\n  self.fetch.polyfill = true\n})(typeof self !== 'undefined' ? self : this);\n"]}